library (Rcmdr)
library (rcmdr)
utils:::menuInstallPkgs()
library (rcmdr)
library (Rcmdr)
library (Rcmdr)
help(hist)
library(RODBC)
library(lattice)
memory.limit(4000)
#Einlesen der Daten (aus Datenbank)
channel="C:\\Dokumente und Einstellungen\\nagel\\Eigene Dateien\\jnProgramme\\ForestSimulator\\data_standsimulation\\localdata.mdb"
channel<-odbcConnectAccess(channel)
#
#
ids <- "20001"
#
#
sqlstrGet<-paste("SELECT ProgBaum.d,ProgBaum.auf,ProgBaum.c66, ProgBaum.art, ProgBaum.aus, ProgBaum.wiederholung, ProgBaum.edvid
FROM ProgBaum WHERE (ProgBaum.aus < 0) AND (ProgBaum.c66 > -99)  and (ProgBaum.d >7) and ProgBaum.edvid='",ids,"'  ",sep="") 
t<-sqlQuery(channel,sqlstrGet)
summary(t)
#
ta <- 2*table(t$wiederholung, 5*round(t$d/5))
ta
barplot(ta, beside=TRUE, cex.lab=1.5, cex.main=1.5, xlab="Durchmesserverteilung [cm]", ylab="Anzahl [St./ha]", main=paste("Durchmesserverteilung nach 600 Jahren",ids,sep=" "),col=c(1:10))
sqlstrGet<-paste("SELECT *
FROM ProgBestand WHERE alt > 2009 and edvid='",ids,"'  ORDER BY alt  ",sep="" ) 
t<-sqlQuery(channel,sqlstrGet)
t$zstpro <- 100*t$vhaazst/t$vhaa
summary(t)
i <- 0
plot(t[t$wiederholung==1,]$alt,t[t$wiederholung==1,]$vhaazst,ylim=c(0,150),cex.lab=1.5, cex.main=1.5,xlab="Jahr", ylab="Volumen Zielstärke [m³/(ha a)]", main=paste("Zielstärkennutzung Variante",ids,sep=" "))
for (i in 0: 10) {
  lines(t[t$wiederholung==i,]$alt,t[t$wiederholung==i,]$vhaazst,col=i)
}
sqlstrGet<-paste("SELECT ProgBestand.edvid, ProgBestand.auf, ProgBestand.simschritt, ProgBestand.wiederholung, ProgBestand.alt, ProgBestand.vha, ProgBestand.vhaa, ProgBestand_1.vha, ProgBestand_1.vhaa
FROM ProgBestand INNER JOIN ProgBestand AS ProgBestand_1 ON (ProgBestand.wiederholung = ProgBestand_1.wiederholung) AND (ProgBestand.simschritt = ProgBestand_1.simschritt+1) AND (ProgBestand.auf = ProgBestand_1.auf)
 AND (ProgBestand.edvid = ProgBestand_1.edvid) WHERE ( ProgBestand.edvid='",ids,"' ) AND (ProgBestand.alt > 2009) ORDER BY ProgBestand.alt ;",sep="") 
t<-sqlQuery(channel,sqlstrGet)
summary(t)
t$iv <- (t$vha+t$vhaa-t$vha.1)/5
hist(t$iv)
i <- 0
plot(t[t$wiederholung==1,]$alt,t[t$wiederholung==1,]$iv,ylim=c(6,18), cex.lab=1.5, cex.main=1.5, xlab="Jahr", ylab="Volumenzuwachs [m³/(ha a)]", main=paste("Volumenzuwachs  Variante:",ids,sep=" ") )
for (i in 0: 10) {
  lines(t[t$wiederholung==i,]$alt,t[t$wiederholung==i,]$iv,col=i+1)
}
sqlstrGet<-paste("SELECT ProgBaum.d,ProgBaum.auf,ProgBaum.c66, ProgBaum.art,ProgBaum.alt, ProgBaum.v,
 ProgBaum.aus,ProgBaum.x, ProgBaum.y
FROM ProgBaum WHERE  ProgBaum.d >=60 and ProgBaum.Art=211 and ProgBaum.aus > 2300 AND ( ProgBaum.edvid='",ids,"' ) ",sep="") 
t<-sqlQuery(channel,sqlstrGet)
summary(t)
hist(t$alt)
plot(t$aus, t$alt)
plot(t$aus,t$v)
plot(t$alt,t$d)
length(t$aus)
    sqlstrGet<-paste("SELECT ProgBaum.d,ProgBaum.auf,ProgBaum.c66, ProgBaum.art,ProgBaum.alt, ProgBaum.v,
      ProgBaum.aus,ProgBaum.x, ProgBaum.y, ProgBaum.wiederholung, ProgBaum.edvid, ProgBaum.zb
      FROM ProgBaum WHERE  ProgBaum.aus > -1 and ProgBaum.Art=211 and ProgBaum.aus > 2300 AND ProgBaum.zb=1  ") 
    t<-sqlQuery(channel,sqlstrGet)
summary(t)
f1 <- t$edvid
f2 <- t$wiederholung
tm <- aggregate(x = t, by = list(f1,f2), FUN = "mean")
boxplot(tm$alt ~ tm$Group.1,ylim=c(100,300),cex.lab=1.5, cex.main=1.5, xlab="Variante", ylab="Zuwachs [m³/ha a]", col=c(3,2,7,7,3,5,5))
    sqlstrGet<-paste("SELECT ProgBaum.d,ProgBaum.auf,ProgBaum.c66, ProgBaum.art,ProgBaum.alt, ProgBaum.v,
      ProgBaum.aus,ProgBaum.x, ProgBaum.y, ProgBaum.wiederholung, ProgBaum.edvid, ProgBaum.zb
      FROM ProgBaum WHERE  ProgBaum.aus > -1 and ProgBaum.Art=211 and ProgBaum.aus > 2300 AND ProgBaum.zb=1 
       AND ProgBaum.edvid != '20001'   ") 
    t<-sqlQuery(channel,sqlstrGet)
summary(t)
f1 <- t$edvid
f2 <- t$wiederholung
tm <- aggregate(x = t, by = list(f1,f2), FUN = "mean")
boxplot(tm$alt ~ tm$Group.1,ylim=c(100,300),cex.lab=1.5, cex.main=1.5, xlab="Variante", ylab="Zuwachs [m³/ha a]", col=c(3,2,7,7,3,5,5))
    sqlstrGet<-paste("SELECT ProgBaum.d,ProgBaum.auf,ProgBaum.c66, ProgBaum.art,ProgBaum.alt, ProgBaum.v,
      ProgBaum.aus,ProgBaum.x, ProgBaum.y, ProgBaum.wiederholung, ProgBaum.edvid, ProgBaum.zb, ProgBaum.edvid 
      FROM ProgBaum WHERE  ProgBaum.aus > -1 and ProgBaum.Art=211 and ProgBaum.aus > 2300 AND ProgBaum.zb=1 
       AND ProgBaum.edvid != '20001'   ") 
    t<-sqlQuery(channel,sqlstrGet)
summary(t)
    sqlstrGet<-paste("SELECT ProgBaum.d,ProgBaum.auf,ProgBaum.c66, ProgBaum.art,ProgBaum.alt, ProgBaum.v,
      ProgBaum.aus,ProgBaum.x, ProgBaum.y, ProgBaum.wiederholung, ProgBaum.edvid, ProgBaum.zb, ProgBaum.edvid 
      FROM ProgBaum WHERE  ProgBaum.aus > -1 and ProgBaum.Art=211 and ProgBaum.aus > 2300 AND ProgBaum.zb=1 
       AND (ProgBaum.edvid <> '20001')   ") 
    t<-sqlQuery(channel,sqlstrGet)
summary(t)
f1 <- t$edvid
f2 <- t$wiederholung
tm <- aggregate(x = t, by = list(f1,f2), FUN = "mean")
boxplot(tm$alt ~ tm$Group.1,ylim=c(100,300),cex.lab=1.5, cex.main=1.5, xlab="Variante", ylab="Zuwachs [m³/ha a]", col=c(3,2,7,7,3,5,5))
    sqlstrGet<-paste("SELECT ProgBaum.d,ProgBaum.auf,ProgBaum.c66, ProgBaum.art,ProgBaum.alt, ProgBaum.v,
      ProgBaum.aus,ProgBaum.x, ProgBaum.y, ProgBaum.wiederholung, ProgBaum.edvid, ProgBaum.zb, ProgBaum.edvid 
      FROM ProgBaum WHERE  ProgBaum.aus > -1 and ProgBaum.Art=211 and ProgBaum.aus > 2300 AND ProgBaum.zb=1 
       AND (ProgBaum.edvid <> '20001') AND (ProgBaum.edvid <> 'SI60Alt')  ") 
    t<-sqlQuery(channel,sqlstrGet)
summary(t)
f1 <- t$edvid
f2 <- t$wiederholung
tm <- aggregate(x = t, by = list(f1,f2), FUN = "mean")
boxplot(tm$alt ~ tm$Group.1,ylim=c(100,300),cex.lab=1.5, cex.main=1.5, xlab="Variante", ylab="Zuwachs [m³/ha a]", col=c(3,2,7,7,3,5,5))
boxplot(tm$alt ~ tm$Group.1,ylim=c(100,300),cex.lab=1.5, cex.main=1.5, xlab="Variante", ylab="Alter der zielstarken Bäume [Jahre]", col=c(3,2,7,7,3,5,5))
boxplot(tm$alt ~ tm$Group.1,ylim=c(150,300),cex.lab=1.5, cex.main=1.5, xlab="Variante", ylab="Alter der zielstarken Bäume [Jahre]", col=c(3,2,7,7,3,5,5))
sqlstrGet<-paste("SELECT ProgBestand.edvid, ProgBestand.auf, ProgBestand.simschritt, ProgBestand.wiederholung, ProgBestand.alt, ProgBestand.vha, ProgBestand.vhaa, ProgBestand_1.vha, ProgBestand_1.vhaa
FROM ProgBestand INNER JOIN ProgBestand AS ProgBestand_1 ON (ProgBestand.wiederholung = ProgBestand_1.wiederholung) AND (ProgBestand.simschritt = ProgBestand_1.simschritt+1) AND (ProgBestand.auf = ProgBestand_1.auf)
 AND (ProgBestand.edvid = ProgBestand_1.edvid) WHERE ( ProgBestand.edvid='",ids,"' ) AND (ProgBestand.alt > 2009) ORDER BY ProgBestand.alt ;",sep="") 
t<-sqlQuery(channel,sqlstrGet)
summary(t)
t$iv <- (t$vha+t$vhaa-t$vha.1)/5
hist(t$iv)
i <- 0
plot(t[t$wiederholung==1,]$alt,t[t$wiederholung==1,]$iv,ylim=c(6,18), cex.lab=1.5, cex.main=1.5, xlab="Jahr", ylab="Volumenzuwachs [m³/(ha a)]", main=paste("Volumenzuwachs  Variante:",ids,sep=" ") )
for (i in 0: 10) {
  lines(t[t$wiederholung==i,]$alt,t[t$wiederholung==i,]$iv,col=i+1)
}
abline(8.6,0)
ids = "Einwuchs Alter 50"
plot(t[t$wiederholung==1,]$alt,t[t$wiederholung==1,]$iv,ylim=c(6,18), cex.lab=1.5, cex.main=1.5, xlab="Jahr", ylab="Volumenzuwachs [m³/(ha a)]", main=paste("Volumenzuwachs  Variante:",ids,sep=" ") )
for (i in 0: 10) {
  lines(t[t$wiederholung==i,]$alt,t[t$wiederholung==i,]$iv,col=i+1)
}
abline(8.6,0)
ids = "Einwuchs Alter 50"
plot(t[t$wiederholung==1,]$alt,t[t$wiederholung==1,]$iv,ylim=c(6,18), cex.lab=1.5, cex.main=1.5, xlab="Jahr", ylab="Volumenzuwachs [m³/(ha a)]", main=paste("Volumenzuwachs  Variante:",ids,sep=" ") )
for (i in 0: 10) {
  lines(t[t$wiederholung==i,]$alt,t[t$wiederholung==i,]$iv,col=3)
}
abline(8.6,0)
i <- 0
ids = "Einwuchs Alter 50"
plot(t[t$wiederholung==1,]$alt,t[t$wiederholung==1,]$iv,ylim=c(6,18), cex.lab=1.5, cex.main=1.5, xlab="Jahr", ylab="Volumenzuwachs [m³/(ha a)]", main=paste("Volumenzuwachs  Variante:",ids,sep=" ") )
for (i in 0: 10) {
  lines(t[t$wiederholung==i,]$alt,t[t$wiederholung==i,]$iv,col=7)
}
abline(8.6,0)
ids = "Einwuchs Alter 50"
plot(t[t$wiederholung==1,]$alt,t[t$wiederholung==1,]$iv,ylim=c(6,18), cex.lab=1.5, cex.main=1.5, xlab="Jahr", ylab="Volumenzuwachs [m³/(ha a)]", main=paste("Volumenzuwachs  Variante:",ids,sep=" ") )
for (i in 0: 10) {
  lines(t[t$wiederholung==i,]$alt,t[t$wiederholung==i,]$iv,col=8)
}
abline(8.6,0)
#
ids = "Einwuchs Alter 50"
plot(t[t$wiederholung==1,]$alt,t[t$wiederholung==1,]$iv,ylim=c(6,18), cex.lab=1.5, cex.main=1.5, xlab="Jahr", ylab="Volumenzuwachs [m³/(ha a)]", main=paste("Volumenzuwachs  Variante:",ids,sep=" ") )
for (i in 0: 10) {
  lines(t[t$wiederholung==i,]$alt,t[t$wiederholung==i,]$iv,col=6)
}
abline(8.6,0)
